{% extends 'base.html' %}
{% load django_bootstrap5 %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4">Search the Category You Want</h2>
    <form method="post">
        {% csrf_token %}
        {% bootstrap_form form %}
        <button type="submit" class="btn btn-outline-primary mt-3">Search</button>
    </form>

    {% if expenses %}
    <h2 class="mt-5">Category Report</h2>
    <table class="table table-striped mt-3">
        <thead>
            <tr>
                <th scope="col">Expense Name</th>
                <th scope="col">Date</th>
                <th scope="col">Amount</th>
                <th scope="col">Category</th>
            </tr>
        </thead>
        <tbody>
            {% for expense in expenses %}
            <tr>
                <td><strong>{{ expense.name }}</strong></td>
                <td>{{ expense.date }}</td>
                <td class="text-success">${{ expense.amount }}</td>
                <td><em>{{ expense.category }}</em></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="mt-3">
        <h5><strong>Total Expenses: <span class="{%if budget_breach%}text-danger{%else%}text-success{%endif%}">${{ total_expenses }}</span></strong></h5>

        {% if budget_breach %}
        <p class="mt-3 text-warning"><strong class="text-danger">DANGER!</strong> Your limit budget for this category is is overreached! </p>
        {% endif %}
      
            
    </div>
    {% else %}
    <div class="alert alert-warning mt-4">
        No expenses found for the selected month and year.
    </div>
    {% endif %}
</div>
{% endblock %}
